# ADX（AdaptiveX）开源项目亮点与关键功能

## 项目定位
ADX 是一个面向工业自动化场景的**自适应多轴运动控制框架**，采用 C/C++ 实现，聚焦“可扩展、可工程落地、可对接硬件”的运动控制能力。  
它不仅覆盖单轴运动，还支持多轴协同、轨迹平滑与插补、参数在线调整，以及硬件抽象接入。

---

## 项目亮点

### 1) 自适应控制能力（Adaptive）
- 支持运行期调整速度、加速度、加加速度、倍率等关键参数。
- 可根据负载与工况变化动态调节控制行为，适配不同工艺节拍。
- 为后续自学习/智能优化算法预留了清晰接口边界。

### 2) 多轴协同与分层架构（X = 可扩展）
- 提供单轴与轴组两套能力：点位、速度、线性插补、状态管理。
- 核心采用分层设计：
  - **flexCore**：核心接口与业务编排。
  - **mcCore**：轴/轴组状态机与运动控制逻辑。
  - **mcHal**：硬件抽象层（电机、IO、编码器等）。
- 上层应用可专注工艺逻辑，下层硬件可独立替换，耦合度低。

### 3) 面向工程的状态机设计
- 轴状态覆盖 DISABLED / STANDSTILL / MOVING / STOPPING / ERRORSTOP 等典型工业流程。
- 通过统一命令入口和参数通道，便于做流程管控、故障恢复与联动控制。

### 4) 轨迹规划与平滑能力
- 集成 Ruckig 等轨迹能力，支持 jerk 约束运动。
- 支持缓冲模式、合并模式（blending）、前瞻平滑等功能，提升轨迹连续性。
- 可用于减少机械冲击、降低振动、改善节拍一致性。

### 5) 工业接口友好
- 提供清晰的 C 接口（`flexCore_if.h`），覆盖初始化、使能、运动、停止、参数读写、状态读取等。
- 兼容 Modbus 风格的通信接入方式，便于上位机/PLC 集成。
- 日志链路完整，便于调试和问题定位。

### 6) 高可验证性
- `app/` 下提供多个测试程序，覆盖典型动作链路：
  - 单轴绝对/相对/速度运动
  - 轴组直线运动与停止
  - 速度倍率调整与多块缓冲
  - 软限位与状态读取
- 对开源用户而言，可作为学习样例，也可直接用于回归测试基线。

---

## 运动控制器设计思想

### 1) “接口稳定、内核可演进”
- 对外保持统一命令模型（使能、运动、停止、读写参数、读状态），降低上层工艺程序改造成本。
- 对内通过分层架构（`flexCore` / `mcCore` / `mcHal`）隔离硬件差异与控制策略，便于持续替换和升级。

### 2) “状态驱动优先于过程耦合”
- 以轴/轴组状态机作为行为约束中心，避免命令随意穿透导致的竞态与不一致。
- 将正常流程、减速停止、故障处理、复位恢复纳入同一状态语义，提升可维护性与可诊断性。

### 3) “实时性与平滑性并重”
- 通过 jerk 约束、前瞻与 blending，在满足节拍的同时减少机械冲击。
- 允许运行期倍率与参数调整，使控制器更好适应负载波动和工艺切换。

### 4) “工程可落地优先”
- 提供明确的 C 接口、日志链路与样例测试，确保从算法能力到现场调试有完整闭环。
- 将可扩展点前置（运动学、驱动适配、组控制策略），支持不同设备形态快速落地。

---

## 借鉴 PLCopen 的地方

ADX 在接口组织与状态语义上明显参考了 PLCopen Motion Control 的工程实践，并结合 C/C++ 控制器实现做了本地化扩展：

### 1) 功能块式能力映射到 C API
- 单轴运动能力与 PLCopen 常见语义对应：
  - 绝对/相对定位（类似 `MC_MoveAbsolute` / `MC_MoveRelative`）
  - 速度运动（类似 `MC_MoveVelocity`）
  - 停止/急停（类似 `MC_Stop` / `MC_Halt`）
- 保留“命令 + 参数 + 状态反馈”的一致调用习惯，便于 PLC 与上位控制逻辑迁移。

### 2) 状态机语义对齐
- 采用 DISABLED / STANDSTILL / MOVING / STOPPING / ERRORSTOP 等工业常见状态表达。
- 对应 PLCopen 强调的“命令触发 + 状态确认 + 故障复位”控制闭环，降低跨平台理解成本。

### 3) BufferMode 与连续轨迹思想
- 支持缓冲执行、运动合并与前瞻平滑，体现与 PLCopen BufferMode 思路一致的连续运动理念。
- 在此基础上引入 jerk 约束与更细粒度轨迹控制，增强高速高精场景下的轨迹品质。

### 4) 轴组与协同控制理念一致
- 轴组创建、使能、组状态读取、线性插补等能力与 PLCopen Group 控制思想一致。
- 同时结合项目自身接口（如龙门同步、电子齿轮、运动学注册）扩展到更复杂机构协同。

---

## 关键功能清单

### 单轴控制
- `adx_MoveAbsolute`：绝对定位
- `adx_MoveRelative`：相对定位
- `adx_MoveVelocity`：速度模式运动
- `adx_Stop` / `adx_Halt`：停止与急停
- `adx_SetOverride`：运行中倍率调整

### 参数与状态
- `adx_ReadParameter` / `adx_WriteParameter`
- `adx_ReadTargetPos` / `adx_ReadActualPos`
- `adx_ReadStatus` / `adx_ReadMultiStatus`
- 支持逻辑位置、实际位置、速度、加速度、jerk 等状态读取

### 轴组与插补
- `adx_CreateAxisGroup` / `adx_GroupEnable`
- `adx_MoveLinearAbsolute`（及相关组运动接口）
- `adx_GroupReadLogicalPos` / `adx_GroupReadStatus`
- 前瞻平滑、缓冲执行、运动合并

### 机械结构协同
- 龙门同步：`adx_SetGantryConfig` / `adx_SetGantryEnable`
- 电子齿轮：`adx_GearIn`

### 可扩展接入
- 支持注册电机使能、位置读取等底层函数
- 支持注册运动学正逆解接口（`adx_SetKinematics`）

---

## 典型应用场景
- 多轴点胶/焊接/喷涂等轨迹跟随工艺
- 搬运与上下料中的路径平滑与节拍控制
- 龙门结构或双轴联动设备
- 需要快速接入不同驱动器/控制板卡的设备平台化项目

---

## 开源价值
- **可读性**：模块边界清晰，接口集中，易于二次开发。
- **可复用性**：单轴、轴组、插补、状态机能力齐全，可按需裁剪。
- **可迁移性**：硬件抽象层设计便于跨平台和多驱动迁移。
- **可演进性**：支持从“规则控制”逐步演进到“自适应/智能控制”。

---

## 快速开始（Windows + CMake）
```bash
cd build
cmake .. 
cmake --build . --config Debug --target install
```
生成工程后构建 Debug 配置，使用 `app/` 下测试程序验证核心运动接口。

---

## 结语
ADX 面向真实工业控制需求，强调“**稳定可用** + **持续扩展**”。
对于希望构建通用运动控制底座、并逐步增强自适应能力的团队，这个项目具备良好的开源基础与工程价值。
